<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Rails and PostgreSQL: Types | Blog of Serhat M. Dündar | Ruby, Rails, Golang, PostgreSQL, AWS, Security</title><meta name=keywords content="rails,postgresql"><meta name=description content="Using PostgreSQL types with Ruby on Rails."><meta name=author content="Serhat M. Dündar"><link rel=canonical href=https://www.serhatdundar.com/posts/rails-and-postgresql-types/><link crossorigin=anonymous href=/assets/css/stylesheet.d7fb4cbf980fe688a21621b06a795933c4e6bb2d4070ec940667af1715d84af2.css integrity="sha256-1/tMv5gP5oiiFiGwanlZM8Tmuy1AcOyUBmevFxXYSvI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.serhatdundar.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.serhatdundar.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.serhatdundar.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.serhatdundar.com/apple-touch-icon.png><link rel=mask-icon href=https://www.serhatdundar.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-45TXZR4LGJ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-45TXZR4LGJ",{anonymize_ip:!1})}</script><meta property="og:title" content="Rails and PostgreSQL: Types"><meta property="og:description" content="Using PostgreSQL types with Ruby on Rails."><meta property="og:type" content="article"><meta property="og:url" content="https://www.serhatdundar.com/posts/rails-and-postgresql-types/"><meta property="og:image" content="https://www.serhatdundar.com/posts/rails-and-postgresql-types/assets/notre-dame-of-paris-seen-from-the-quai-de-la-tournelle-1863.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-11-09T19:24:20+02:00"><meta property="article:modified_time" content="2018-11-09T19:24:20+02:00"><meta property="og:site_name" content="Blog of Serhat M. Dündar"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.serhatdundar.com/posts/rails-and-postgresql-types/assets/notre-dame-of-paris-seen-from-the-quai-de-la-tournelle-1863.jpg"><meta name=twitter:title content="Rails and PostgreSQL: Types"><meta name=twitter:description content="Using PostgreSQL types with Ruby on Rails."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.serhatdundar.com/posts/"},{"@type":"ListItem","position":2,"name":"Rails and PostgreSQL: Types","item":"https://www.serhatdundar.com/posts/rails-and-postgresql-types/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Rails and PostgreSQL: Types","name":"Rails and PostgreSQL: Types","description":"Using PostgreSQL types with Ruby on Rails.","keywords":["rails","postgresql"],"articleBody":"During nokul we’ve heavily implemented PostgreSQL features into our Rails application. Unfortunately, ActiveRecord doesn’t come with constraint support for PostgreSQL, but rein does a fantastic job covering what’s missing in ActiveRecord. We believe that, one shouldn’t rely on a web application, that is very prone for human-error, when it comes to data integrity. Therefore our PostgreSQL tables included various constraints and limits.\nBelow you will find a set of rules that we’ve investigated, implemented and battle tested with various types.\nString Type Do not use limit: N in migrations for string type. Instead, use add_length_constraint.\nIf you aren’t sure about the length of a string field, add 255 limit in the constraint, similar to the MySQL approach:\nadd_length_constraint :table, :column, less_than_or_equal_to: 255 If length of an attribute is constant, consider using equal_to:\nadd_length_constraint :users, :id_number, equal_to: 11 Do not use text type in migrations. Instead use string type and add_length_constraint with 65535 limit, similar to the MySQL approach. This will protect you from cells with crazy amount of data:\nadd_length_constraint :decisions, :description, less_than_or_equal_to: 65535 Use presence and unique constraints whenever necessary:\nadd_presence_constraint :countries, :name add_unique_constraint :users, :email varchar VS varchar(n) VS char VS text PostgreSQL doesn’t have a limit for string type by default. Technically, one can insert gigabytes of data into a string field, therefore we’ve adopted a hard limit, 65535, similar to the MySQL approach. There isn’t a performance or size difference between varchar (n) and text in PostgreSQL. varchar(n) LOCKs the table in case of a change, that often causes downtimes. Therefore limits shouldn’t be added to the column, instead they should be added as a CHECK. Integer Type Do not use limit: N in migrations for integer type.\nIntegers attributes often expected to return 0, instead of nil in case of non-existence. Therefore, add a null_constraint if you don’t have a good reason not to:\nadd_null_constraint :users, :articles_count Defining a default value (often 0) will make sense most of the time. Also add a null_constraint together with the default value:\nt.integer :articles_count, default: 0 add_null_constraint :users, :articles_count Add a numericality_constraint constraint, if you aren’t planning to accept a negative value in the column:\nadd_numericality_constraint :users, :articles_count, greater_than_or_equal_to: 0 For numbers with exact upper and lower bounds, add numericality_constraint:\nadd_numericality_constraint :articles, :month, greater_than_or_equal_to: 1, less_than_or_equal_to: 12 add_numericality_constraint :articles, :year, greater_than_or_equal_to: 1950, less_than_or_equal_to: 2050 Float Type float: Useful when accuracy isn’t very important and when you’re only interested in 3-5 numbers after the comma. Also useful when you are running complex arithmetic with these numbers.\ndecimal: Useful when accuracy is very important (as in money), even more important than the performance.\nFor both types, always add null_constraint if you’ve defined a default value:\nt.decimal :min_credit, precision: 5, scale: 2, default: 0 add_null_constraint :course_types, :min_credit For both types, add a numericality_constraint if you aren’t accepting negative values:\nadd_numericality_constraint :course_types, :min_credit, greater_than_or_equal_to: 0 Often a float or decimal attribute isn’t expected to return nil in case of non-existence, instead, they’re expected to return 0. Therefore, add a null_constraint if you don’t have a good reason not to do so:\nadd_null_constraint :course_types, :min_credit Float \u0026 Decimal There are some differences between float and decimal in PostgreSQL. First of all, let’s start with checking what Rails produces for each type:\nt.float :incentive_point | Column | Type | Nullable | | --------------- | ---------------- | -------- | | incentive_point | double precision | | t.decimal :min_credit, precision: 5, scale: 2 | Column | Type | Nullable | | ------ | ------------ | -------- | | credit | numeric(5,2) | | So, types in Rails converted into the following types in PostgreSQL:\nfloat -\u003e double_precision decimal -\u003e numeric(x, y) \u0026 decimal(x, y) If we dig into these types in PostgreSQL:\n| name | size | description | range | in-rails | | ---------------- | -------- | ----------- | --------------------------------------------------------------------------- | -------- | | decimal (p, s) | variable | exact | p(total digits), s(digits after decimal point), max(p)=131072, max(s)=16383 | decimal | | numeric (p, s) | variable | exact | p(total digits), s(digits after decimal point), max(p)=131072, max(s)=16383 | decimal | | double-precision | 8-bytes | inexact | 15 significant digits, unlimited size | float | Briefly:\ndecimal and numeric types are the same in PostgreSQL. decimal and numeric types are exact, but double-precision is inexact. decimal and numeric types have some limits, while double-precision can be unlimited. Exact? exact types store the data as it’s submitted, however inexact types aren’t. Therefore, numberic type should be preferred in cases where precision is important.\nBoolean Type Always add a null_constraint for boolean columns:\nadd_null_constraint :students, :active Always add a default value for boolean columns:\nt.boolean :students, active: false A boolean field often isn’t expected to return nil. For example:\nStudent.where(active: nil).count =\u003e 50 Student.where(active: false).count =\u003e 40 Student.where(active: true).count =\u003e 60 In this case, it’s very hard to tell how many students are active, and how many of them aren’t. The data shown above needs to be corrected to before analyzed. Therefore, stick with the two rules explained here.\nReference Type Use null: false for foreign_key columns, if there is no optional: true relation in between:\nAdd foreign_key constraint to ensure referential integrity:\nt.references :unit, null: false, foreign_key: true Add foreign_key constraints directly to the column, instead of as a CHECK, as these columns typically not expected to change very often.\nReferences https://www.depesz.com/2010/03/02/charx-vs-varcharx-vs-varchar-vs-text/ https://stackoverflow.com/questions/4848964/postgresql-difference-between-text-and-varchar-character-varying https://dba.stackexchange.com/questions/125499/what-is-the-overhead-for-varcharn/125526#125526 https://dba.stackexchange.com/questions/89429/would-index-lookup-be-noticeably-faster-with-char-vs-varchar-when-all-values-are/89433#89433 https://gist.github.com/icyleaf/9089250 https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb https://stackoverflow.com/questions/38053596/benchmark-bigint-vs-int-on-postgresql https://stackoverflow.com/questions/2966524/calculating-and-saving-space-in-postgresql/7431468#7431468 http://forums.devshed.com/postgresql-help-21/numeric-vs-float-607281.html https://stackoverflow.com/a/20887107/818033 https://www.linuxtopia.org/online_books/database_guides/Practical_PostgreSQL_database/PostgreSQL_x2632_004.htm https://stackoverflow.com/a/8523253/818033 ","wordCount":"901","inLanguage":"en","image":"https://www.serhatdundar.com/posts/rails-and-postgresql-types/assets/notre-dame-of-paris-seen-from-the-quai-de-la-tournelle-1863.jpg","datePublished":"2018-11-09T19:24:20+02:00","dateModified":"2018-11-09T19:24:20+02:00","author":{"@type":"Person","name":"Serhat M. Dündar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.serhatdundar.com/posts/rails-and-postgresql-types/"},"publisher":{"@type":"Organization","name":"Blog of Serhat M. Dündar | Ruby, Rails, Golang, PostgreSQL, AWS, Security","logo":{"@type":"ImageObject","url":"https://www.serhatdundar.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.serhatdundar.com/ accesskey=h title="Home (Alt + H)"><img src=https://www.serhatdundar.com/apple-touch-icon.png alt=logo aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.serhatdundar.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://www.serhatdundar.com/archives/ title=archives><span>archives</span></a></li><li><a href=https://www.serhatdundar.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://www.serhatdundar.com/art/ title=artwork><span>artwork</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.serhatdundar.com/>Home</a>&nbsp;»&nbsp;<a href=https://www.serhatdundar.com/posts/>Posts</a></div><h1 class=post-title>Rails and PostgreSQL: Types</h1><div class=post-description>Using PostgreSQL types with Ruby on Rails.</div><div class=post-meta><span title='2018-11-09 19:24:20 +0200 +0200'>November 9, 2018</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Serhat M. Dündar&nbsp;|&nbsp;<a href=https://github.com/msdundar/msdundar.github.io/tree/main/content/posts/rails-and-postgresql-types/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://www.serhatdundar.com/posts/rails-and-postgresql-types/assets/notre-dame-of-paris-seen-from-the-quai-de-la-tournelle-1863.jpg alt="Notre Dame of Paris seen from the Quai de la Tournelle (1863) - Johan Barthold Jongkind"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#string-type aria-label="String Type">String Type</a><ul><li><a href=#varchar-vs-varcharn-vs-char-vs-text aria-label="varchar VS varchar(n) VS char VS text"><code>varchar</code> VS <code>varchar(n)</code> VS <code>char</code> VS <code>text</code></a></li></ul></li><li><a href=#integer-type aria-label="Integer Type">Integer Type</a></li><li><a href=#float-type aria-label="Float Type">Float Type</a><ul><li><a href=#float--decimal aria-label="Float &amp;amp; Decimal">Float & Decimal</a></li><li><a href=#exact aria-label=Exact?>Exact?</a></li></ul></li><li><a href=#boolean-type aria-label="Boolean Type">Boolean Type</a></li><li><a href=#reference-type aria-label="Reference Type">Reference Type</a></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><p>During <a href=https://github.com/omu/nokul>nokul</a> we&rsquo;ve heavily implemented PostgreSQL features into our
Rails application. Unfortunately, ActiveRecord doesn&rsquo;t come with constraint support for PostgreSQL,
but <a href=https://github.com/nullobject/rein>rein</a> does a fantastic job covering what&rsquo;s missing in ActiveRecord.
We believe that, one shouldn&rsquo;t rely on a web application, that is very prone for human-error, when it comes
to data integrity. Therefore our PostgreSQL tables included various constraints and limits.</p><p>Below you will find a set of rules that we&rsquo;ve investigated, implemented and battle tested with various types.</p><hr><h2 id=string-type>String Type<a hidden class=anchor aria-hidden=true href=#string-type>#</a></h2><ul><li><p>Do not use <code>limit: N</code> in migrations for <code>string</code> type. Instead, use <code>add_length_constraint</code>.</p></li><li><p>If you aren&rsquo;t sure about the length of a string field, add <code>255</code> limit in the constraint, similar to the MySQL approach:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_length_constraint <span style=color:#e6db74>:table</span>, <span style=color:#e6db74>:column</span>, <span style=color:#e6db74>less_than_or_equal_to</span>: <span style=color:#ae81ff>255</span>
</span></span></code></pre></div></li><li><p>If length of an attribute is constant, consider using <code>equal_to</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_length_constraint <span style=color:#e6db74>:users</span>, <span style=color:#e6db74>:id_number</span>, <span style=color:#e6db74>equal_to</span>: <span style=color:#ae81ff>11</span>
</span></span></code></pre></div></li><li><p>Do not use <code>text</code> type in migrations. Instead use <code>string</code> type and <code>add_length_constraint</code> with <code>65535</code>
limit, similar to the MySQL approach. This will protect you from cells with crazy amount of data:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_length_constraint <span style=color:#e6db74>:decisions</span>, <span style=color:#e6db74>:description</span>, <span style=color:#e6db74>less_than_or_equal_to</span>: <span style=color:#ae81ff>65535</span>
</span></span></code></pre></div></li><li><p>Use <code>presence</code> and <code>unique</code> constraints whenever necessary:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_presence_constraint <span style=color:#e6db74>:countries</span>, <span style=color:#e6db74>:name</span>
</span></span><span style=display:flex><span>add_unique_constraint <span style=color:#e6db74>:users</span>, <span style=color:#e6db74>:email</span>
</span></span></code></pre></div></li></ul><hr><h3 id=varchar-vs-varcharn-vs-char-vs-text><code>varchar</code> VS <code>varchar(n)</code> VS <code>char</code> VS <code>text</code><a hidden class=anchor aria-hidden=true href=#varchar-vs-varcharn-vs-char-vs-text>#</a></h3><ul><li>PostgreSQL doesn&rsquo;t have a limit for <code>string</code> type by default. Technically, one can insert gigabytes of data into a string field, therefore we&rsquo;ve adopted a hard limit, <code>65535</code>, similar to the MySQL approach.</li><li>There isn&rsquo;t a performance or size difference between <code>varchar (n)</code> and <code>text</code> in PostgreSQL.</li><li><code>varchar(n)</code> LOCKs the table in case of a change, that often causes downtimes. Therefore <code>limits</code> shouldn&rsquo;t be added to the column, instead they should be added as a <code>CHECK</code>.</li></ul><hr><h2 id=integer-type>Integer Type<a hidden class=anchor aria-hidden=true href=#integer-type>#</a></h2><ul><li><p>Do not use <code>limit: N</code> in migrations for <code>integer</code> type.</p></li><li><p>Integers attributes often expected to return <code>0</code>, instead of <code>nil</code> in case of non-existence. Therefore,
add a <code>null_constraint</code> if you don&rsquo;t have a good reason not to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_null_constraint <span style=color:#e6db74>:users</span>, <span style=color:#e6db74>:articles_count</span>
</span></span></code></pre></div></li><li><p>Defining a default value (often <code>0</code>) will make sense most of the time. Also add a <code>null_constraint</code> together
with the default value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>t<span style=color:#f92672>.</span>integer <span style=color:#e6db74>:articles_count</span>, <span style=color:#e6db74>default</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>add_null_constraint <span style=color:#e6db74>:users</span>, <span style=color:#e6db74>:articles_count</span>
</span></span></code></pre></div></li><li><p>Add a <code>numericality_constraint</code> constraint, if you aren&rsquo;t planning to accept a negative value in the column:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_numericality_constraint <span style=color:#e6db74>:users</span>, <span style=color:#e6db74>:articles_count</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>greater_than_or_equal_to</span>: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div></li><li><p>For numbers with exact upper and lower bounds, add <code>numericality_constraint</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_numericality_constraint <span style=color:#e6db74>:articles</span>, <span style=color:#e6db74>:month</span>,
</span></span><span style=display:flex><span>                                        <span style=color:#e6db74>greater_than_or_equal_to</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                                        <span style=color:#e6db74>less_than_or_equal_to</span>: <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span>add_numericality_constraint <span style=color:#e6db74>:articles</span>, <span style=color:#e6db74>:year</span>,
</span></span><span style=display:flex><span>                                        <span style=color:#e6db74>greater_than_or_equal_to</span>: <span style=color:#ae81ff>1950</span>,
</span></span><span style=display:flex><span>                                        <span style=color:#e6db74>less_than_or_equal_to</span>: <span style=color:#ae81ff>2050</span>
</span></span></code></pre></div></li></ul><hr><h2 id=float-type>Float Type<a hidden class=anchor aria-hidden=true href=#float-type>#</a></h2><ul><li><p><code>float</code>: Useful when accuracy isn&rsquo;t very important and when you&rsquo;re only interested in 3-5 numbers after the comma. Also useful when you are running complex arithmetic with these numbers.</p></li><li><p><code>decimal</code>: Useful when accuracy is very important (as in money), even more important than the performance.</p></li><li><p>For both types, always add <code>null_constraint</code> if you&rsquo;ve defined a <code>default</code> value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>t<span style=color:#f92672>.</span>decimal <span style=color:#e6db74>:min_credit</span>, <span style=color:#e6db74>precision</span>: <span style=color:#ae81ff>5</span>, <span style=color:#e6db74>scale</span>: <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>default</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>add_null_constraint <span style=color:#e6db74>:course_types</span>, <span style=color:#e6db74>:min_credit</span>
</span></span></code></pre></div></li><li><p>For both types, add a <code>numericality_constraint</code> if you aren&rsquo;t accepting negative values:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_numericality_constraint <span style=color:#e6db74>:course_types</span>, <span style=color:#e6db74>:min_credit</span>,
</span></span><span style=display:flex><span>                                           <span style=color:#e6db74>greater_than_or_equal_to</span>: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div></li><li><p>Often a <code>float</code> or <code>decimal</code> attribute isn&rsquo;t expected to return <code>nil</code> in case of non-existence, instead, they&rsquo;re
expected to return 0. Therefore, add a <code>null_constraint</code> if you don&rsquo;t have a good reason not to do so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_null_constraint <span style=color:#e6db74>:course_types</span>, <span style=color:#e6db74>:min_credit</span>
</span></span></code></pre></div></li></ul><hr><h3 id=float--decimal>Float & Decimal<a hidden class=anchor aria-hidden=true href=#float--decimal>#</a></h3><p>There are some differences between <code>float</code> and <code>decimal</code> in PostgreSQL. First of all, let&rsquo;s start with checking
what Rails produces for each type:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>t<span style=color:#f92672>.</span>float <span style=color:#e6db74>:incentive_point</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>Column</span>          <span style=color:#f92672>|</span> <span style=color:#66d9ef>Type</span>             <span style=color:#f92672>|</span> <span style=color:#66d9ef>Nullable</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#f92672>---------------</span> <span style=color:#f92672>|</span> <span style=color:#f92672>----------------</span> <span style=color:#f92672>|</span> <span style=color:#f92672>--------</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> incentive_point <span style=color:#f92672>|</span> double precision <span style=color:#f92672>|</span>          <span style=color:#f92672>|</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>t<span style=color:#f92672>.</span>decimal <span style=color:#e6db74>:min_credit</span>, <span style=color:#e6db74>precision</span>: <span style=color:#ae81ff>5</span>, <span style=color:#e6db74>scale</span>: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>Column</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Type</span>         <span style=color:#f92672>|</span> <span style=color:#66d9ef>Nullable</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#f92672>------</span> <span style=color:#f92672>|</span> <span style=color:#f92672>------------</span> <span style=color:#f92672>|</span> <span style=color:#f92672>--------</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> credit <span style=color:#f92672>|</span> numeric(<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>2</span>) <span style=color:#f92672>|</span>          <span style=color:#f92672>|</span>
</span></span></code></pre></div><p>So, types in Rails converted into the following types in PostgreSQL:</p><ul><li><code>float</code> -> <code>double_precision</code></li><li><code>decimal</code> -> <code>numeric(x, y)</code> & <code>decimal(x, y)</code></li></ul><p>If we dig into these types in PostgreSQL:</p><pre tabindex=0><code>| name             | size     | description | range                                                                       | in-rails |
| ---------------- | -------- | ----------- | --------------------------------------------------------------------------- | -------- |
| decimal (p, s)   | variable | exact       | p(total digits), s(digits after decimal point), max(p)=131072, max(s)=16383 | decimal  |
| numeric (p, s)   | variable | exact       | p(total digits), s(digits after decimal point), max(p)=131072, max(s)=16383 | decimal  |
| double-precision | 8-bytes  | inexact     | 15 significant digits, unlimited size                                       | float    |
</code></pre><p>Briefly:</p><ul><li><code>decimal</code> and <code>numeric</code> types are the same in PostgreSQL.</li><li><code>decimal</code> and <code>numeric</code> types are <strong>exact</strong>, but <code>double-precision</code> is <strong>inexact</strong>.</li><li><code>decimal</code> and <code>numeric</code> types have some limits, while <code>double-precision</code> can be unlimited.</li></ul><h3 id=exact>Exact?<a hidden class=anchor aria-hidden=true href=#exact>#</a></h3><p><code>exact</code> types store the data as it&rsquo;s submitted, however <code>inexact</code> types aren&rsquo;t. Therefore, <code>numberic</code> type should
be preferred in cases where precision is important.</p><hr><h2 id=boolean-type>Boolean Type<a hidden class=anchor aria-hidden=true href=#boolean-type>#</a></h2><ul><li><p>Always add a <code>null_constraint</code> for <code>boolean</code> columns:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>add_null_constraint <span style=color:#e6db74>:students</span>, <span style=color:#e6db74>:active</span>
</span></span></code></pre></div></li><li><p>Always add a <code>default</code> value for <code>boolean</code> columns:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>t<span style=color:#f92672>.</span>boolean <span style=color:#e6db74>:students</span>, <span style=color:#e6db74>active</span>: <span style=color:#66d9ef>false</span>
</span></span></code></pre></div></li></ul><p>A <code>boolean</code> field often isn&rsquo;t expected to return <code>nil</code>. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>Student</span><span style=color:#f92672>.</span>where(<span style=color:#e6db74>active</span>: <span style=color:#66d9ef>nil</span>)<span style=color:#f92672>.</span>count <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>Student</span><span style=color:#f92672>.</span>where(<span style=color:#e6db74>active</span>: <span style=color:#66d9ef>false</span>)<span style=color:#f92672>.</span>count <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>Student</span><span style=color:#f92672>.</span>where(<span style=color:#e6db74>active</span>: <span style=color:#66d9ef>true</span>)<span style=color:#f92672>.</span>count <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>60</span>
</span></span></code></pre></div><p>In this case, it&rsquo;s very hard to tell how many students are active, and how many of them aren&rsquo;t. The data shown above needs to be corrected to before analyzed. Therefore, stick with the two rules explained here.</p><hr><h2 id=reference-type>Reference Type<a hidden class=anchor aria-hidden=true href=#reference-type>#</a></h2><ul><li><p>Use <code>null: false</code> for <code>foreign_key</code> columns, if there is no <code>optional: true</code> relation in between:</p></li><li><p>Add <code>foreign_key</code> constraint to ensure referential integrity:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>t<span style=color:#f92672>.</span>references <span style=color:#e6db74>:unit</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>null</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>foreign_key</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div></li><li><p>Add <code>foreign_key</code> constraints directly to the column, instead of as a <code>CHECK</code>, as these columns typically not
expected to change very often.</p></li></ul><hr><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://www.depesz.com/2010/03/02/charx-vs-varcharx-vs-varchar-vs-text/>https://www.depesz.com/2010/03/02/charx-vs-varcharx-vs-varchar-vs-text/</a></li><li><a href=https://stackoverflow.com/questions/4848964/postgresql-difference-between-text-and-varchar-character-varying>https://stackoverflow.com/questions/4848964/postgresql-difference-between-text-and-varchar-character-varying</a></li><li><a href=https://dba.stackexchange.com/questions/125499/what-is-the-overhead-for-varcharn/125526#125526>https://dba.stackexchange.com/questions/125499/what-is-the-overhead-for-varcharn/125526#125526</a></li><li><a href=https://dba.stackexchange.com/questions/89429/would-index-lookup-be-noticeably-faster-with-char-vs-varchar-when-all-values-are/89433#89433>https://dba.stackexchange.com/questions/89429/would-index-lookup-be-noticeably-faster-with-char-vs-varchar-when-all-values-are/89433#89433</a></li><li><a href=https://gist.github.com/icyleaf/9089250>https://gist.github.com/icyleaf/9089250</a></li><li><a href=https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html>https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html</a></li><li><a href=https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb>https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb</a></li><li><a href=https://stackoverflow.com/questions/38053596/benchmark-bigint-vs-int-on-postgresql>https://stackoverflow.com/questions/38053596/benchmark-bigint-vs-int-on-postgresql</a></li><li><a href=https://stackoverflow.com/questions/2966524/calculating-and-saving-space-in-postgresql/7431468#7431468>https://stackoverflow.com/questions/2966524/calculating-and-saving-space-in-postgresql/7431468#7431468</a></li><li><a href=http://forums.devshed.com/postgresql-help-21/numeric-vs-float-607281.html>http://forums.devshed.com/postgresql-help-21/numeric-vs-float-607281.html</a></li><li><a href=https://stackoverflow.com/a/20887107/818033>https://stackoverflow.com/a/20887107/818033</a></li><li><a href=https://www.linuxtopia.org/online_books/database_guides/Practical_PostgreSQL_database/PostgreSQL_x2632_004.htm>https://www.linuxtopia.org/online_books/database_guides/Practical_PostgreSQL_database/PostgreSQL_x2632_004.htm</a></li><li><a href=https://stackoverflow.com/a/8523253/818033>https://stackoverflow.com/a/8523253/818033</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.serhatdundar.com/tags/rails/>rails</a></li><li><a href=https://www.serhatdundar.com/tags/postgresql/>postgresql</a></li></ul><nav class=paginav><a class=prev href=https://www.serhatdundar.com/posts/packing-js-projects-for-aws-lambda-with-grunt/><span class=title>« Prev</span><br><span>Packing JS projects for AWS Lambda with Grunt</span></a>
<a class=next href=https://www.serhatdundar.com/posts/rails-and-postgresql-constraints/><span class=title>Next »</span><br><span>Rails and PostgreSQL: Constraints</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Rails and PostgreSQL: Types on twitter" href="https://twitter.com/intent/tweet/?text=Rails%20and%20PostgreSQL%3a%20Types&url=https%3a%2f%2fwww.serhatdundar.com%2fposts%2frails-and-postgresql-types%2f&hashtags=rails%2cpostgresql"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Rails and PostgreSQL: Types on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.serhatdundar.com%2fposts%2frails-and-postgresql-types%2f&title=Rails%20and%20PostgreSQL%3a%20Types&summary=Rails%20and%20PostgreSQL%3a%20Types&source=https%3a%2f%2fwww.serhatdundar.com%2fposts%2frails-and-postgresql-types%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Rails and PostgreSQL: Types on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.serhatdundar.com%2fposts%2frails-and-postgresql-types%2f&title=Rails%20and%20PostgreSQL%3a%20Types"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Rails and PostgreSQL: Types on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.serhatdundar.com%2fposts%2frails-and-postgresql-types%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Rails and PostgreSQL: Types on whatsapp" href="https://api.whatsapp.com/send?text=Rails%20and%20PostgreSQL%3a%20Types%20-%20https%3a%2f%2fwww.serhatdundar.com%2fposts%2frails-and-postgresql-types%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Rails and PostgreSQL: Types on telegram" href="https://telegram.me/share/url?text=Rails%20and%20PostgreSQL%3a%20Types&url=https%3a%2f%2fwww.serhatdundar.com%2fposts%2frails-and-postgresql-types%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.serhatdundar.com/>Blog of Serhat M. Dündar | Ruby, Rails, Golang, PostgreSQL, AWS, Security</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>